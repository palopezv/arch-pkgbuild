# Maintainer: Marcin Karpezo <sirmacik at gmail dot com>
pkgname=uname-git
pkgver=121.fa00fe8
pkgrel=1
pkgdesc="Micro-emacs version customized by Linus Torvalds"
arch=('i686' 'x86_64')
url="http://git.kernel.org/?p=editors/uemacs/uemacs.git;a=summary"
license=('custom')
depends=('ncurses')
makedepends=('git')
source=(helplocation.patch)
source=("$pkgname::git://git.kernel.org/pub/scm/editors/uemacs/uemacs.git"
	"helplocation.patch")
sha256sums=('SKIP'
            'e904800034d46973dcccc7f7d711d286773abe1105227a43bf838d8e1fcb5c22')

pkgver() {
	cd $pkgname
	echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

build() {
	cd "$srcdir/$pkgname"
	# patch to make uemacs look for a helpfile in the correct location
	patch -p1 < ../helplocation.patch || return 1

	sed -i "s@BINDIR=/usr/bin@BINDIR=${pkgdir}/usr/bin@;s@LIBDIR=/usr/lib@LIBDIR=${pkgdir}/usr/share/doc/uemacs@" Makefile  >>  Makefile
	make || return 1

}

package () {
    
	cd "$pkgdir/$pkgname"
	mkdir -p ${pkgdir}/usr/bin
	mkdir -p ${pkgdir}/usr/share/doc/uemacs
	make install || return 1
}
