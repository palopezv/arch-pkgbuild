
pkgname=irssi-svn
pkgver=5234 
pkgrel=1
pkgdesc="Modular text mode IRC client with Perl scripting"
url="http://irssi.org/"
arch=('i686' 'x86_64')
license="GPL"
depends=('glib2' 'openssl')
makedepends=('subversion' 'html2text' 'pkgconfig')
optdepends=('perl-libwww: used for scriptassist')
backup=(etc/irssi.conf)
conflicts=('irssi' 'irssi-cvs', 'irssi-git')
provides=('irssi' 'irssi-cvs' 'irssi-git')
source=("$pkgname::svn+http://svn.irssi.org/repos/irssi/trunk/"
	'html2text.patch')
sha256sums=('SKIP'
            '94bcce32e30ecde9432d2994d029085d25b9060a73654245b7712f1760d4373b')

pkgver() {
  cd "$pkgname"
  svnversion | tr -d [A-z]
}

build() {
  cd "$srcdir"/"$pkgname"
   patch -p1 -i ../html2text.patch
  ./autogen.sh --prefix=/usr \
    --enable-ipv6 \
    --with-proxy \
    --sysconfdir=/etc \
    --with-perl-lib=vendor
  make
}

package() {
  cd "$srcdir"/"$pkgname"
  make DESTDIR="$pkgdir" install
  rm -f "$pkgdir"/usr/lib/irssi/modules/*.la # Drop rogue libtool files.
  rm -rf  "$pkgdir"/usr/lib/perl5/core_perl
}
